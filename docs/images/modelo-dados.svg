<svg xmlns="http://www.w3.org/2000/svg" width="2240" height="1220" viewBox="0 0 2240 1220">
  <defs>
    <style>
      .bg { fill: #f8fafc; }
      .title { font: 700 34px Arial, sans-serif; fill: #0f172a; }
      .subtitle { font: 500 18px Arial, sans-serif; fill: #475569; }
      .box { fill: #ffffff; stroke: #0f172a; stroke-width: 2; rx: 14; }
      .box-title { font: 700 22px Arial, sans-serif; fill: #ffffff; }
      .line { font: 17px Arial, sans-serif; fill: #0f172a; }
      .rel { font: 700 15px Arial, sans-serif; }
      .note { font: 16px Arial, sans-serif; fill: #334155; }
    </style>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,5 L0,10 z" fill="currentColor" />
    </marker>
  </defs>

  <rect class="bg" x="0" y="0" width="2240" height="1220" />
  <text class="title" x="1120" y="48" text-anchor="middle">Projeto de Vacinacao contra o HPV - Modelo de Dados</text>
  <text class="subtitle" x="1120" y="78" text-anchor="middle">Visao simplificada (entidades e relacionamentos principais)</text>

  <!-- Coluna 1: Core + Accounts -->
  <rect class="box" x="80" y="120" width="460" height="150" />
  <rect x="80" y="120" width="460" height="40" fill="#0f172a" />
  <text class="box-title" x="310" y="147" text-anchor="middle">core_school</text>
  <text class="line" x="100" y="186">PK id</text>
  <text class="line" x="100" y="212">name, inep_code</text>
  <text class="line" x="100" y="238">address, territory_ref</text>

  <rect class="box" x="80" y="350" width="460" height="170" />
  <rect x="80" y="350" width="460" height="40" fill="#0b8f6c" />
  <text class="box-title" x="310" y="377" text-anchor="middle">accounts_user</text>
  <text class="line" x="100" y="416">PK id</text>
  <text class="line" x="100" y="442">email (unique), full_name</text>
  <text class="line" x="100" y="468">role (ADMIN / ESCOLA / SAUDE)</text>
  <text class="line" x="100" y="494">FK school_id (nullable)</text>

  <rect class="box" x="80" y="620" width="460" height="190" />
  <rect x="80" y="620" width="460" height="40" fill="#1d4ed8" />
  <text class="box-title" x="310" y="647" text-anchor="middle">core_student</text>
  <text class="line" x="100" y="686">PK id, FK school_id</text>
  <text class="line" x="100" y="712">full_name, birth_date, sex</text>
  <text class="line" x="100" y="738">guardian_name, guardian_contact</text>
  <text class="line" x="100" y="764">audit fields (created/updated)</text>

  <!-- Coluna 2: Immunization -->
  <rect class="box" x="840" y="120" width="500" height="130" />
  <rect x="840" y="120" width="500" height="40" fill="#7c3aed" />
  <text class="box-title" x="1090" y="147" text-anchor="middle">immunization_vaccine</text>
  <text class="line" x="860" y="186">PK id</text>
  <text class="line" x="860" y="212">code (unique), name</text>

  <rect class="box" x="840" y="300" width="500" height="150" />
  <rect x="840" y="300" width="500" height="40" fill="#9333ea" />
  <text class="box-title" x="1090" y="327" text-anchor="middle">immunization_vaccinescheduleversion</text>
  <text class="line" x="860" y="366">PK id, code (unique), name</text>
  <text class="line" x="860" y="392">is_active, audit fields</text>

  <rect class="box" x="840" y="520" width="500" height="190" />
  <rect x="840" y="520" width="500" height="40" fill="#a855f7" />
  <text class="box-title" x="1090" y="547" text-anchor="middle">immunization_vaccinedoserule</text>
  <text class="line" x="860" y="586">PK id, FK schedule_version_id</text>
  <text class="line" x="860" y="612">FK vaccine_id, dose_number</text>
  <text class="line" x="860" y="638">recommended_min/max_age_months</text>
  <text class="line" x="860" y="664">UNIQUE(schedule_version, vaccine, dose)</text>

  <rect class="box" x="840" y="800" width="500" height="210" />
  <rect x="840" y="800" width="500" height="40" fill="#c084fc" />
  <text class="box-title" x="1090" y="827" text-anchor="middle">immunization_vaccinationrecord</text>
  <text class="line" x="860" y="866">PK id, FK student_id, FK vaccine_id</text>
  <text class="line" x="860" y="892">dose_number, application_date, source</text>
  <text class="line" x="860" y="918">notes, audit fields</text>
  <text class="line" x="860" y="944">UNIQUE(student, vaccine, dose)</text>

  <!-- Coluna 3: Analytics + Audit -->
  <rect class="box" x="1520" y="220" width="620" height="120" />
  <rect x="1520" y="220" width="620" height="40" fill="#b45309" />
  <text class="box-title" x="1830" y="247" text-anchor="middle">analytics_dashboardpreference</text>
  <text class="line" x="1540" y="286">PK id, FK user_id (1:1), age_buckets_json</text>

  <rect class="box" x="1520" y="430" width="620" height="140" />
  <rect x="1520" y="430" width="620" height="40" fill="#0ea5e9" />
  <text class="box-title" x="1830" y="457" text-anchor="middle">audit_auditlog</text>
  <text class="line" x="1540" y="496">PK id, FK actor_id (nullable)</text>
  <text class="line" x="1540" y="522">action, entity_type, entity_id, timestamp</text>

  <rect class="box" x="1520" y="700" width="620" height="150" />
  <rect x="1520" y="700" width="620" height="40" fill="#0284c7" />
  <text class="box-title" x="1830" y="727" text-anchor="middle">audit_errorlog</text>
  <text class="line" x="1540" y="766">PK id, FK actor_id (nullable)</text>
  <text class="line" x="1540" y="792">method, path, status_code, trace_id</text>
  <text class="line" x="1540" y="818">message, details_json, timestamp</text>

  <!-- Relacionamentos: todos em corredores livres -->
  <polyline points="310,270 310,350" fill="none" stroke="#0b8f6c" stroke-width="4" stroke-dasharray="8 6" marker-end="url(#arrow)" color="#0b8f6c"/>
  <text class="rel" x="324" y="316" fill="#0b8f6c">1:N</text>

  <polyline points="150,270 40,270 40,715 80,715" fill="none" stroke="#1d4ed8" stroke-width="4" marker-end="url(#arrow)" color="#1d4ed8"/>
  <text class="rel" x="48" y="500" fill="#1d4ed8">1:N</text>

  <polyline points="540,435 700,435 700,280 1520,280" fill="none" stroke="#b45309" stroke-width="4" marker-end="url(#arrow)" color="#b45309"/>
  <text class="rel" x="1070" y="268" fill="#b45309">1:1</text>

  <polyline points="540,470 720,470 720,500 1520,500" fill="none" stroke="#0ea5e9" stroke-width="4" marker-end="url(#arrow)" color="#0ea5e9"/>
  <text class="rel" x="1080" y="490" fill="#0ea5e9">1:N</text>

  <polyline points="540,505 740,505 740,775 1520,775" fill="none" stroke="#0284c7" stroke-width="4" marker-end="url(#arrow)" color="#0284c7"/>
  <text class="rel" x="1080" y="764" fill="#0284c7">1:N</text>

  <polyline points="540,715 690,715 690,905 840,905" fill="none" stroke="#1d4ed8" stroke-width="4" marker-end="url(#arrow)" color="#1d4ed8"/>
  <text class="rel" x="700" y="700" fill="#1d4ed8">1:N</text>

  <polyline points="1340,375 840,375" fill="none" stroke="#9333ea" stroke-width="4" marker-end="url(#arrow)" color="#9333ea"/>
  <text class="rel" x="1090" y="365" fill="#9333ea">1:N</text>

  <polyline points="1340,185 1400,185 1400,615 1340,615" fill="none" stroke="#7c3aed" stroke-width="4" marker-end="url(#arrow)" color="#7c3aed"/>
  <text class="rel" x="1410" y="402" fill="#7c3aed">1:N</text>

  <polyline points="1340,185 1440,185 1440,905 1340,905" fill="none" stroke="#7c3aed" stroke-width="4" marker-end="url(#arrow)" color="#7c3aed"/>
  <text class="rel" x="1450" y="550" fill="#7c3aed">1:N</text>

  <rect x="840" y="1060" width="1300" height="96" rx="10" fill="#ffffff" stroke="#94a3b8" stroke-width="2" />
  <text class="note" x="860" y="1093">Obs.: referencias de created_by_id / updated_by_id para accounts_user existem em varias tabelas</text>
  <text class="note" x="860" y="1119">e foram omitidas para manter este diagrama legivel.</text>
</svg>